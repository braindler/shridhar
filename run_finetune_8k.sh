#!/bin/bash
# run_finetune_8k.sh

echo "üöÄ –ó–∞–ø—É—Å–∫ —Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥–∞ Braindler —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º 8K"

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source venv/bin/activate

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..."
pip install peft bitsandbytes wandb

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º W&B
export WANDB_PROJECT="braindler-8k-finetune"
export WANDB_MODE="online"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å GPU
echo "üîç –ü—Ä–æ–≤–µ—Ä—è—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å GPU..."
nvidia-smi

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—É—á–µ–Ω–∏–µ —Å DeepSpeed
echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é –æ–±—É—á–µ–Ω–∏–µ —Å DeepSpeed..."
deepspeed --num_gpus=1 finetune_braindler_8k.py

echo "‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
